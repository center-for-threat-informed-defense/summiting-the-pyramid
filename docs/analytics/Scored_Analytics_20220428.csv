Name,Analytic,Score,Notes,Link
Mimikatz Execution,"logsource:
    category: process_creation
    product: windows
detection:
    selection_tools_name:
        CommandLine|contains:
            - 'DumpCreds'
            - 'mimikatz'
    selection_function_names: # To cover functions from modules that are not in module_names
        CommandLine|contains:
            - '::aadcookie' #misc module
            - '::detours' #misc module
            - '::memssp' #misc module
            - '::mflt' #misc module
            - '::ncroutemon' #misc module
            - '::ngcsign' #misc module
            - '::printnightmare' #misc module
            - '::skeleton' #misc module
            - '::preshutdown'  #service module
            - '::mstsc'  #ts module
            - '::multirdp'  #ts module
    selection_module_names:
        CommandLine|contains:
            - 'rpc::'
            - 'token::'
            - 'crypto::'
            - 'dpapi::'
            - 'sekurlsa::'
            - 'kerberos::'
            - 'lsadump::'
            - 'privilege::'
            - 'process::'
            - 'vault::'
    condition: 1 of selection_*",1,The specific moduels would be at level two. The first selection is just the name of the tool that can be changed on the comand line.,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_mimikatz_command_line.yml
Defrag Deactivation,"logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image|endswith: '\schtasks.exe'
        CommandLine|contains:
            - '/delete'
            - '/change'
        CommandLine|contains|all:
            - '/TN'
            - '\Microsoft\Windows\Defrag\ScheduledDefrag'
    condition: selection",3,these conditions are all based off of native tooling in windows.,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_slingshot.yml
Turla Group Lateral Movement ,"logsource:
    category: process_creation
    product: windows
detection:
    selection:
        CommandLine:
            - 'net use \\\\%DomainController%\C$ ""P@ssw0rd"" *'
            - 'dir c:\\*.doc* /s'
            - 'dir %TEMP%\\*.exe'
    condition: selection",1,This is looking for very basic strings and enviroment variables that will change over time. Also don't put the password in the analytic that can change or it can increase your risk.,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_turla_commands_critical.yml
CobaltStrike Named Pipe Patterns,"logsource:
    product: windows
    category: pipe_created
detection:
    selection_malleable_profiles:
        - PipeName|startswith:
            - '\mojo.5688.8052.183894939787088877'
            - '\mojo.5688.8052.35780273329370473'
            - '\mypipe-f'
            - '\mypipe-h'
            - '\ntsvcs'
            - '\scerpc'
            - '\win_svc'
            - '\spoolss'
            - '\msrpc_'
            - '\win\msrpc_'
            - '\wkssvc'
            - '\f53f'
            - '\windows.update.manager'
            - '\SearchTextHarvester'
            - '\DserNamePipe'
            - '\PGMessagePipe'
            - '\MsFteWds'
            - '\f4c3'
            - '\fullduplex_'
            - '\rpc_'
        - PipeName:
            - '\demoagent_11'
            - '\demoagent_22'
    selection_malleable_profile_CatalogChangeListener:
        PipeName|startswith: '\Winsock2\CatalogChangeListener-'
        PipeName|endswith: '-0,'
    filter:
        PipeName:
            - '\wkssvc'
            - '\spoolss'
            - '\scerpc'
            - '\ntsvcs'
            - '\SearchTextHarvester'
            - '\PGMessagePipe'
            - '\MsFteWds'
    condition: 1 of selection_malleable_profile* and not filter",1,This is all just PipeNames that can be changed like enviroment variables. ,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/pipe_created_susp_cobaltstrike_pipe_patterns.yml
Persistence,"process where host.os.type == ""windows"" and event.type == ""start"" and
  process.parent.executable : ""C:\\Windows\\System32\\svchost.exe"" and
  process.parent.args : ""UsoSvc""",4,This is looking for the windows API that starts the process and checks the arguments. Because they are ANDed together it follows the higher of the elements.,https://github.com/elastic/detection-rules/blob/411ec36ff0171d6eaa3b9cc53478585b856253dd/rules/windows/persistence_via_update_orchestrator_service_hijack.toml
Detect Credential Dumping through LSASS access,`sysmon` EventCode=10 TargetImage=*lsass.exe (GrantedAccess=0x1010 OR GrantedAccess=0x1410),TBD,GrantedAccess is still under investigation as to where we will score this. More on this to come.,https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_credential_dumping_through_lsass_access.yml
Create Remote Thread into LSASS,`sysmon` EventID=8 TargetImage=*lsass.exe,5,Sysmon eventID 8 is hooking directly int the CreateRemoteThread API call.,https://github.com/splunk/security_content/blob/develop/detections/endpoint/create_remote_thread_into_lsass.yml
Data Exfiltration to Unsanctioned Apps,"logsource:
    service: threat_management
    product: m365
detection:
    selection:
        eventSource: SecurityComplianceCenter
        eventName: 'Data exfiltration to unsanctioned apps'
        status: success
    condition: selection",Out of Scope,This is basicly only relying on the quality of the data source triggering a log of this type.,https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/m365/microsoft365_data_exfiltration_to_unsanctioned_app.yml
Microsoft 365 - Impossible Travel Activity,"logsource:
    service: threat_management
    product: m365
detection:
    selection:
        eventSource: SecurityComplianceCenter
        eventName: 'Impossible travel activity'
        status: success",Out of Scope,This is basicly only relying on the quality of the data source triggering a log of this type.,https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/m365/microsoft365_impossible_travel_activity.yml
Disable Or Stop Services,"logsource:
    category: process_creation
    product: linux
detection:
    selection:
        Image|endswith:
            - '/service'
            - '/systemctl'
            - '/chkconfig'
        CommandLine|contains:
            - 'stop'
            - 'disable'
    condition: selection",3,This is using native linux tools and their command line arguments.,https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_services_stop_and_disable.yml
Disable Security Tools,"logsource:
    category: process_creation
    product: macos
detection:
    launchctl_unload:
        Image: '/bin/launchctl'
        CommandLine|contains: 'unload'
    security_plists:
        CommandLine|contains:
            - 'com.objective-see.lulu.plist'                     # Objective-See firewall management utility
            - 'com.objective-see.blockblock.plist'               # Objective-See persistence locations watcher/blocker
            - 'com.google.santad.plist'                          # google santa
            - 'com.carbonblack.defense.daemon.plist'             # carbon black
            - 'com.carbonblack.daemon.plist'                     # carbon black
            - 'at.obdev.littlesnitchd.plist'                     # Objective Development Software firewall management utility
            - 'com.tenablesecurity.nessusagent.plist'            # Tenable Nessus
            - 'com.opendns.osx.RoamingClientConfigUpdater.plist' # OpenDNS Umbrella
            - 'com.crowdstrike.falcond.plist'                    # Crowdstrike Falcon
            - 'com.crowdstrike.userdaemon.plist'                 # Crowdstrike Falcon
            - 'osquery'                                          # facebook osquery
            - 'filebeat'                                         # elastic log file shipper
            - 'auditbeat'                                        # elastic auditing agent/log shipper
            - 'packetbeat'                                       # elastic network logger/shipper
            - 'td-agent'                                         # fluentd log shipper",TBD,This is a MacOS specific analytic and the location of the security tools might be specal so this could be a high level analytic but more research into MacOS needs to be done.,https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_disable_security_tools.yml
Possible Shadow Credentials Added,"logsource:
    product: windows
    service: security
detection:
    selection:
        EventID: 5136
        AttributeLDAPDisplayName: 'msDS-KeyCredentialLink'
    condition: selection",TBD,This uses a windows eventID and our current guidence is that those are at the highest level. I think we are going to look at this  again as the field looks like it could use some improvement.,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_susp_possible_shadow_credentials_added.yml
Turla PNG Dropper Service,"detection:
    selection:
        Provider_Name: 'Service Control Manager'
        EventID: 7045
        ServiceName: 'WerFaultSvc'
    condition: selection",1,"This uses an eventID 7045 to detect a new service being created with the name of ""WerFaultSvc"". This should be very uncommon but it is relying on Turla not changing the name of the file.",https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/win_system_apt_turla_service_png.yml
Eventlog Cleared,"detection:
    selection:
        EventID: 104
        Provider_Name: 'Microsoft-Windows-Eventlog'",TBD,The eventID 104 is for 'The %3 log file was cleared' And when the provider name is that of the event log it would have been cleared. This looks to be dependent on the OS file locations. ,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/win_system_eventlog_cleared.yml
WMI Persistence,"logsource:
    product: windows
    service: wmi
detection:
    wmi_filter_to_consumer_binding:
        EventID: 5861
    consumer_keywords:
        - 'ActiveScriptEventConsumer'
        - 'CommandLineEventConsumer'
        - 'CommandLineTemplate'
        # - 'Binding EventFilter'  # too many false positive with HP Health Driver
    wmi_filter_registration:
        EventID: 5859",TBD,Changes to WMI subscriptions are well covered by a number of EventIDs and this takes advantage of that leading to a very difficult to eveade detection.,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/wmi/win_wmi_persistence.yml
Suspicious Access To Browser Credential Files,"logsource:
    category: file_access
    product: windows
detection:
    selection_ie:
        FileName|endswith: '\Appdata\Local\Microsoft\Windows\WebCache\WebCacheV01.dat'
    selection_firefox:
        FileName|endswith:
            - '\cookies.sqlite'
            - 'release\key3.db'  # Firefox
            - 'release\key4.db'  # Firefox
            - 'release\logins.json' # Firefox
    selection_chromium:
        FileName|contains:
            - '\AppData\Local\Google\Chrome\User Data\Default\Network\Cookies'
            - '\Appdata\Local\Chrome\User Data\Default\Login Data'
            - '\AppData\Local\Google\Chrome\User Data\Local State'",2,This relies on the configurations of the browser.,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_access/file_access_win_browser_credential_stealing.yml
Startup Folder File Write,"logsource:
    product: windows
    category: file_event
detection:
    selection:
        TargetFilename|contains: '\Microsoft\Windows\Start Menu\Programs\StartUp'",3,This relies on a Windows default file location.,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_startup_folder_file_write.yml
Windows Binaries Write Suspicious Extensions,"logsource:
    category: file_event
    product: windows
detection:
    selection_generic:
        Image|endswith:
            - '\smss.exe'
            - '\RuntimeBroker.exe'
            - '\sihost.exe'
            - '\lsass.exe'
            - '\csrss.exe'
            - '\winlogon.exe'
            - '\wininit.exe'
        TargetFilename|endswith:
            - '.bat'
            - '.vbe'
            - '.txt'
            - '.vbs'
            - '.exe'
            - '.ps1'
            - '.hta'
            - '.iso'
            - '.dll'
    selection_special:
        Image|endswith:
            - '\rundll32.exe'
            - '\svchost.exe'
            - '\dllhost.exe'
        TargetFilename|endswith:
            - '.bat'
            - '.vbe'
            - '.vbs'
            - '.ps1'
            - '.hta'
            - '.iso'
    condition: 1 of selection_*",1,Depends on the target file name.,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_shell_write_susp_files_extensions.yml
New Outlook Macro Created,"logsource:
    category: file_event
    product: windows
detection:
    selection:
        Image|endswith: '\outlook.exe'
        TargetFilename|endswith: '\Microsoft\Outlook\VbaProject.OTM'
    condition: selection",1,Depends on the target file name.,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_office_outlook_macro_creation.yml
Suspicious LNK Double Extension Files,"logsource:
    category: file_event
    product: windows
detection:
    selection:
        TargetFilename|endswith: '.lnk'
        TargetFilename|contains:
            - '.doc.'
            - '.docx.'
            - '.xls.'
            - '.xlsx.'
            - '.ppt.'
            - '.pptx.'
            - '.jpg.'
            - '.pdf.'",1,Depends on the target file name.,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_susp_lnk_double_extension.yml
Potential Persistence Via Outlook Form,"logsource:
    product: windows
    category: file_event
detection:
    selection:
        Image|endswith: '\outlook.exe'
        TargetFilename|contains:
            - '\AppData\Local\Microsoft\FORMS\IPM'
            - '\Local Settings\Application Data\Microsoft\Forms' # Windows XP
    condition: selection",1,Depends on the target file name.,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_event/file_event_win_office_outlook_newform.yml
Time Travel Debugging Utility Usage - Image,"logsource:
    product: windows
    category: image_load
detection:
    selection:
        ImageLoaded|endswith:
            - '\ttdrecord.dll'
            - '\ttdwriter.dll'
            - '\ttdloader.dll'
    condition: selection",2,This tracks the loading of downloaded software. There are some built in time travel debugging tools in windows so this might be possible to move to a level 3. However in that case you might miss the custom software so both might be needed.,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_tttracer_mod_load.yml
Service Registry Permissions Weakness Check,"logsource:
    product: windows
    category: ps_script
detection:
    selection:
        ScriptBlockText|contains|all:
            - 'get-acl'
            - 'REGISTRY::HKLM\SYSTEM\CurrentControlSet\Services\'
    condition: selection",3,"This is looking for the act of checking the permissions on a registry key. This can be done in many ways and this is only one. Techniquly this is at level 3, however, I don't think this is a very good analytic.",https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_get_acl_service.yml
Clear PowerShell History - PowerShell,"logsource:
    product: windows
    category: ps_script
detection:
    selection1a:
        ScriptBlockText|contains:
            - 'del'
            - 'Remove-Item'
            - 'rm'
    selection1b:
        ScriptBlockText|contains: '(Get-PSReadlineOption).HistorySavePath'
    selection_2:
        ScriptBlockText|contains|all:
            - 'Set-PSReadlineOption'
            - '–HistorySaveStyle'  # not sure if the homoglyph –/- is intended, just checking for both
            - 'SaveNothing'
    selection_3:
        ScriptBlockText|contains|all:
            - 'Set-PSReadlineOption'
            - '-HistorySaveStyle'
            - 'SaveNothing'
    condition: 1 of selection_* or all of selection1*",3,All of this is built in powershell dependent.,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_clear_powershell_history.yml
MSI Install from Suspicious Locations,"logsource:
    product: windows
    service: application
detection:
    selection:
        Provider_Name: 'MsiInstaller'
        EventID:
            - 1040
            - 1042
        Data|contains:
            # Add more suspicious paths
            - '\Users\Public\'
            - '\PerfLogs\'
            - '\Desktop\'
            # - '\Downloads\'  # too many FPs, typical legitimate staging directory
            # - '\AppData\Local\Temp\'  # too many FPs
            - 'C:\Windows\TEMP\'
            - '\\\\'
    filter_winget:
        Data|contains: '\AppData\Local\Temp\WinGet\'
    filter_updhealthtools:
        Data|contains: 'C:\Windows\TEMP\UpdHealthTools.msi'
    condition: selection and not 1 of filter_*",1,Analytic is dependent on where the files originate. Event IDs would be intersting to look at in the future,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/msiinstaller/win_msi_install_from_susp_locations.yml
MSI install from the web,"logsource:
    product: windows
    service: application
detection:
    selection:
        Provider_Name: 'MsiInstaller'
        EventID:
            - 1040
            - 1042
        Data|contains: '://'
    condition: selection",?,"Needs additional work. Not sure where to put ""://""",https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/msiinstaller/win_msi_install_from_web.yml
Windows Vuln CVE 2021_41379,"logsource:
    product: windows
    service: application
detection:
    selection:
        EventID: 1033
        Provider_Name: 'MsiInstaller'
        Data|contains: 'test pkg'
    condition: selection",1,Looking for specific test package,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/msiinstaller/win_vul_cve_2021_41379.yml
New BITS Job Created Via PowerShell,"logsource:
    product: windows
    service: bits-client
detection:
    selection:
        EventID: 3
        processPath|endswith:
            - '\powershell.exe'
            - '\pwsh.exe'
    condition: selection",3,Utilizes BITS application logs. Looking for process path executed with PowerShell,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/bits_client/win_bits_client_new_job_via_powershell.yml
CAR-2014-03-005: Remotely Launched Executables via Servies,"process = search Process:Create
flow = search Flow:Start
service = filter process where (parent_exe == ""services.exe"")
remote_start = join (flow, service ) where (
 flow.hostname == service.hostname and
 flow.pid == service.pid and
 (flow.time < service.time < flow.time + 1 second)
)
output remote_start",3,Flow is at the level of the logsource. Time is irrelevant to score in this context.,https://car.mitre.org/analytics/CAR-2014-03-005/
Suspicious Remote Thread Source,"logsource:
    product: windows
    category: create_remote_thread
detection:
    selection:
        SourceImage|endswith:
            - '\bash.exe'
            - '\cvtres.exe'
            - '\cscript.exe'
            - '\defrag.exe'
            - '\dnx.exe'
            - '\esentutl.exe'
            - '\excel.exe'
            - '\expand.exe'
            - '\explorer.exe'
            - '\find.exe'
            - '\findstr.exe'
            - '\forfiles.exe'
            # - '\git.exe'
            - '\gpupdate.exe'
            - '\hh.exe'
            - '\iexplore.exe'
            - '\installutil.exe'
            - '\lync.exe'
            - '\makecab.exe'
            - '\mDNSResponder.exe'
            - '\monitoringhost.exe'
            - '\msbuild.exe'
            - '\mshta.exe'
            - '\msiexec.exe'
            - '\mspaint.exe'
            - '\outlook.exe'
            - '\ping.exe'
            - '\powerpnt.exe'
            - '\provtool.exe'
            - '\python.exe'
            - '\regsvr32.exe'
            - '\robocopy.exe'
            - '\runonce.exe'
            - '\sapcimc.exe'
            - '\schtasks.exe'
            - '\smartscreen.exe'
            - '\spoolsv.exe'
            # - '\taskhost.exe'  # disabled due to false positives
            - '\tstheme.exe'
            - '\userinit.exe'
            - '\vssadmin.exe'
            - '\vssvc.exe'
            - '\w3wp.exe'
            - '\winlogon.exe'
            - '\winscp.exe'
            - '\wmic.exe'
            - '\winword.exe'
            - '\wscript.exe'
    filter_vs:
        - SourceImage|contains: 'Visual Studio'
        - SourceParentImage|contains: '\Programs\Microsoft VS Code\'
    filter2:
        SourceImage: 'C:\Windows\System32\winlogon.exe'
        TargetImage:
            - 'C:\Windows\System32\services.exe' # happens on Windows 7
            - 'C:\Windows\System32\wininit.exe' # happens on Windows 7
            - 'C:\Windows\System32\csrss.exe' # multiple OS
    filter2b:
        SourceImage: 'C:\Windows\System32\winlogon.exe'
        TargetParentImage: 'System'
        TargetParentProcessId: 4
    filter3:
        SourceImage: 'C:\Windows\System32\provtool.exe'
        TargetParentProcessId: 0
    filter4:
        SourceImage|endswith: '\git.exe'
        TargetImage|endswith:
            - '\git.exe'
            - 'C:\Windows\System32\conhost.exe'
    filter5:
        SourceImage: 'C:\Windows\System32\VSSVC.exe'
        TargetImage: 'System'
    filter_powershell:
        SourceParentImage: 'C:\Windows\System32\CompatTelRunner.exe'
    filter_schtasks_conhost:
        SourceImage:
            - 'C:\Windows\System32\schtasks.exe'
            - 'C:\Windows\SysWOW64\schtasks.exe'
        TargetImage: 'C:\Windows\System32\conhost.exe'
    filter_nvidia:
        SourceImage: 'C:\Windows\explorer.exe'
        TargetImage: 'C:\Program Files\NVIDIA Corporation\NVIDIA GeForce Experience\NVIDIA GeForce Experience.exe'
    #filter_powerpnt:
    #    # Raised by the following issue: https://github.com/SigmaHQ/sigma/issues/2479
    #    SourceImage|contains: '\Microsoft Office\'
    #    SourceImage|endswith: '\POWERPNT.EXE'
    #    TargetImage: 'C:\Windows\System32\csrss.exe'
    condition: selection and not 1 of filter*",3,Create_remote_thread is Sysmon event 8. Most tools are native tools. ,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/create_remote_thread/create_remote_thread_win_susp_remote_thread_source.yml
Mimikatz Use,"logsource:
    product: windows
detection:
    keywords:
        - 'dpapi::masterkey'
        - 'eo.oe.kiwi'
        - 'event::clear'
        - 'event::drop'
        - 'gentilkiwi.com'
        - 'kerberos::golden'
        - 'kerberos::ptc'
        - 'kerberos::ptt'
        - 'kerberos::tgt'
        - 'Kiwi Legit Printer'
        - 'lsadump::'
        - 'mimidrv.sys'
        - '\mimilib.dll'
        - 'misc::printnightmare'
        - 'misc::shadowcopies'
        - 'misc::skeleton'
        - 'privilege::backup'
        - 'privilege::debug'
        - 'privilege::driver'
        - 'sekurlsa::'
    filter:
        EventID: 15  # Sysmon's FileStream Events (could cause false positives when Sigma rules get copied on/to a system)
    condition: keywords and not filter",2,OR search that looks for keywords within any event. Limited by the tool specifically,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/win_alert_mimikatz_keywords.yml
Backup Catalog Deleted,"logsource:
    product: windows
    service: application
detection:
    selection:
        EventID: 524
        Provider_Name: Microsoft-Windows-Backup
    condition: selection",SCORED AT LEVEL OF DATA SOURCE,Not sure where Event code 524 hooks into,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/microsoft_windows_backup/win_susp_backup_delete.yml
Process Acess Windows Direct Syscall NtOpenProcess,"logsource:
    category: process_access
    product: windows
detection:
    selection:
        CallTrace|startswith: 'UNKNOWN'
    falsepositive1:
        TargetImage: 'C:\Program Files\Cylance\Desktop\CylanceUI.exe'
        SourceImage: 'C:\Windows\Explorer.EXE'
    falsepositive2:
        TargetImage: 'C:\Program Files (x86)\Microsoft\EdgeUpdate\MicrosoftEdgeUpdate.exe'
        SourceImage|startswith: 'C:\Program Files (x86)\Microsoft\Temp\'
        SourceImage|endswith: '\MicrosoftEdgeUpdate.exe'
    falsepositive3:
        TargetImage|endswith: 'vcredist_x64.exe'
        SourceImage|endswith: 'vcredist_x64.exe'
    falsepositive4:
        TargetImage: 'C:\Windows\system32\systeminfo.exe'
        SourceImage|endswith: 'setup64.exe' #vmware
    falsepositive5:
        TargetImage|endswith: 'AmazonSSMAgentSetup.exe'
        SourceImage|endswith: 'AmazonSSMAgentSetup.exe'
    falsepositive6:
        TargetImage|endswith: 'C:\Program Files\Mozilla Firefox\firefox.exe'
        SourceImage|endswith: 'C:\Program Files\Mozilla Firefox\firefox.exe'
    falsepositive7: # VsCode
        TargetImage|endswith: '\AppData\Local\Programs\Microsoft VS Code\Code.exe'
        SourceImage|endswith: '\AppData\Local\Programs\Microsoft VS Code\Code.exe'
    falsepositive8: # Google Chrome
        TargetImage|endswith: 'C:\Program Files\Google\Chrome\Application\chrome.exe'
        SourceImage|endswith: 'C:\Program Files\Google\Chrome\Application\chrome.exe'
    falsepositive9: # Google Chrome Update
        TargetImage|endswith: 'C:\Program Files (x86)\Google\Update\GoogleUpdate.exe'
        SourceImage|endswith: 'C:\Program Files (x86)\Google\Update\GoogleUpdate.exe'
    falsepositive10: # MS Teams
        TargetImage|endswith: '\AppData\Local\Microsoft\Teams\current\Teams.exe'
        SourceImage|endswith: '\AppData\Local\Microsoft\Teams\current\Teams.exe'
    falsepositives11:
        TargetImage: 'C:\Windows\System32\backgroundTaskHost.exe'
        SourceImage: 'C:\Windows\System32\backgroundTaskHost.exe'
    falsepositives12:
        TargetImage: 'C:\Program Files (x86)\CCleaner Browser\Application\CCleanerBrowser.exe'
        SourceImage: 'C:\Program Files (x86)\CCleaner Browser\Application\CCleanerBrowser.exe'
    falsepositives13: # Discord
        TargetImage|startswith: 'C:\Users\'
        TargetImage|contains: '\AppData\Local\Discord\'
        TargetImage|endswith: '\Discord.exe'
    falsepositives14:
        TargetImage: 'C:\WINDOWS\system32\AUDIODG.EXE'
    falsepositives15:
        SourceImage|startswith: 'C:\Users\'
        SourceImage|contains: '\AppData\Local\yammerdesktop\app-'
        SourceImage|endswith: '\Yammer.exe'
        TargetImage|startswith: 'C:\Users\'
        TargetImage|contains: '\AppData\Local\yammerdesktop\app-'
        TargetImage|endswith: '\Yammer.exe'
        GrantedAccess: '0x1000'
    falsepositive_kerneltrace_edge:  # Cases in which the CallTrace is just e.g. 'UNKNOWN(19290435374)' from Microsoft-Windows-Kernel-Audit-API-Calls provider
        Provider_Name: 'Microsoft-Windows-Kernel-Audit-API-Calls'
    falsepositives_mixed:
        TargetImage|endswith: '\Evernote\Evernote.exe'
    condition: selection and not 1 of falsepositive*",TAG FOR RESEARCH,,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_direct_syscall_ntopenprocess.yml
File Creation Date Changed to Another Year,"logsource:
    category: file_change
    product: windows
detection:
    selection1:
        PreviousCreationUtcTime|startswith: '2022'
    filter1:
        CreationUtcTime|startswith: '2022'
    selection2:
        PreviousCreationUtcTime|startswith: '202'
    filter2:
        CreationUtcTime|startswith: '202'
    gen_filter_updates:
        - Image:
            - 'C:\Windows\system32\ProvTool.exe'
            - 'C:\Windows\System32\usocoreworker.exe'
            - 'C:\Windows\ImmersiveControlPanel\SystemSettings.exe'
        - TargetFilename|startswith: 'C:\ProgramData\USOPrivate\UpdateStore\'
        - TargetFilename|endswith:
            - '.tmp'
            - '.temp'
    gen_filter_tiworker:
        Image|startswith: 'C:\WINDOWS\'
        Image|endswith: '\TiWorker.exe'
        TargetFilename|endswith: '.cab'
    condition: (( selection1 and not filter1 ) or ( selection2 and not filter2 )) and not 1 of gen_filter*",1,Focused on specific time values as opposed to change behavior,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file/file_change/file_change_win_2022_timestomping.yml
Diagnostic Library Sdiageng.DLL Loaded By Msdt.EXE,"logsource:
    category: image_load
    product: windows
detection:
    selection:
        Image|endswith: '\msdt.exe'
        ImageLoaded|endswith: '\sdiageng.dll'
    condition: selection",1,Wildcard for image begins with prohibits the analytic from being higher,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_dll_sdiageng_load_by_msdt.yml
Suspicious Encoded Scripts in a WMI Consumer,"logsource:
    product: windows
    category: wmi_event
detection:
    selection_destination:
        Destination|base64offset|contains:
            - 'WriteProcessMemory'
            - 'This program cannot be run in DOS mode'
            - 'This program must be run under Win32'
    condition: selection_destination",,,https://github.com/SigmaHQ/sigma/blob/master/rules/windows/wmi_event/sysmon_wmi_susp_encoded_scripts.yml
